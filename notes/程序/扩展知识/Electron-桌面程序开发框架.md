---
title: Electron-æ¡Œé¢ç¨‹åºå¼€å‘æ¡†æ¶
author: MycroftCooper
created: 2025-04-27 23:32
lastModified: 2025-04-27 23:32
tags:
  - ç¨‹åº
  - Electron
  - å·¥å…·
category: ç¨‹åº/æ‰©å±•çŸ¥è¯†
note status: è‰ç¨¿
---
# 1. ä»€ä¹ˆæ˜¯ Electronï¼Ÿ

ä¸€å¥è¯è§£é‡Šï¼šElectron æ˜¯ä¸€ä¸ªå¯ä»¥ç”¨ **å‰ç«¯æŠ€æœ¯ï¼ˆHTML/CSS/JavaScriptï¼‰å¼€å‘æ¡Œé¢åº”ç”¨ç¨‹åº** çš„æ¡†æ¶ã€‚

å®ƒ**æŠŠ Chrome æµè§ˆå™¨ + Node.js æ‰“åŒ…åˆ°äº†ä¸€èµ·**ï¼Œç„¶åï¼š

- ç”¨ Chrome æ¥æ¸²æŸ“ç•Œé¢ï¼ˆå‰ç«¯æŠ€æœ¯ï¼‰
- ç”¨ Node.js æ¥è®¿é—®æœ¬åœ°æ–‡ä»¶ã€æ“ä½œç³»ç»Ÿï¼ˆåç«¯èƒ½åŠ›ï¼‰

æ‰€ä»¥ï¼ŒElectronåº”ç”¨ï¼š

- å¯ä»¥åƒç½‘é¡µä¸€æ ·å†™ç•Œé¢
- åˆå¯ä»¥åƒæœ¬åœ°ç¨‹åºä¸€æ ·ï¼Œè¯»å†™æ–‡ä»¶ã€æ“ä½œç£ç›˜ã€è°ƒç”¨æœ¬åœ° API

**ç®€å•è¯´ï¼ŒElectron = æµè§ˆå™¨ + åç«¯ = æ¡Œé¢åº”ç”¨å¼€å‘ç¥å™¨**

**Electronçš„è¯­è¨€æ”¯æŒ:**

| è¯­è¨€                | ç”¨æ¥åšä»€ä¹ˆ                                     |
| ------------------- | ---------------------------------------------- |
| **HTML**            | è´Ÿè´£é¡µé¢ç»“æ„                                   |
| **CSS**             | è´Ÿè´£é¡µé¢æ ·å¼                                   |
| **JavaScript**      | è´Ÿè´£é¡µé¢é€»è¾‘ã€åº”ç”¨é€»è¾‘ã€æ“ä½œç³»ç»Ÿé€»è¾‘           |
| (å¯é€‰) TypeScript   | å¦‚æœæƒ³è¦æ›´å¼ºçš„ç±»å‹æ£€æŸ¥ï¼ŒElectronä¹Ÿæ”¯æŒ         |
| (å¯é€‰) å…¶ä»–å‰ç«¯æ¡†æ¶ | ä½ å¯ä»¥æ­é… Vueã€Reactã€Svelte ç­‰æ¥å†™æ›´å¤§çš„é¡¹ç›® |

**æ€»ç»“ä¸€å¥è¯ï¼š** ä¸»è¦å°±æ˜¯**JavaScript + HTML + CSS**ã€‚

# 2. ç¯å¢ƒæ­å»º

**ç¬¬1æ­¥ï¼šåˆå§‹åŒ–é¡¹ç›®**

é¦–å…ˆï¼Œå’±ä»¬åœ¨æœ¬åœ°å»ºä¸€ä¸ªæ–°é¡¹ç›®æ–‡ä»¶å¤¹,ç„¶åæ‰“å¼€ç»ˆç«¯ï¼ˆæˆ–è€…VSCode Terminalï¼‰ï¼š

```bash
cd ä½ çš„é¡¹ç›®ç›®å½•
npm init -y
```

è¿™ä¸€æ­¥ç”Ÿæˆä¸€ä¸ªæœ€åŸºæœ¬çš„ `package.json` æ–‡ä»¶ã€‚

âœ… å®Œæˆä¹‹åï¼Œç›®å½•é‡Œåº”è¯¥æœ‰ä¸€ä¸ª `package.json` æ–‡ä»¶äº†ã€‚

**ç¬¬2æ­¥ï¼šå®‰è£… Electron**

åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹è¿è¡Œï¼š

```bash
npm install electron --save-dev
```

âœ… è¿™æ ·æˆ‘ä»¬å°±æŠŠ Electron è£…åˆ°äº†æœ¬åœ°ï¼Œè€Œä¸æ˜¯å…¨å±€å®‰è£…ï¼Œä¾¿äºç‰ˆæœ¬ç®¡ç†ã€‚

æ£€æŸ¥ä¸€ä¸‹ `package.json`ï¼Œåº”è¯¥å¤šäº†ï¼š

```json
"devDependencies": {
  "electron": "^ç‰ˆæœ¬å·"
}
```

**ç¬¬3æ­¥ï¼šæ­å»ºåŸºç¡€ç›®å½•ç»“æ„**

é¡¹ç›®ç›®å½•åº”è¯¥æ˜¯è¿™æ ·ï¼š

```
project-folder/
â”œâ”€ main.js          # ä¸»è¿›ç¨‹å…¥å£
â”œâ”€ preload.js       # (å¯é€‰) é¢„åŠ è½½è„šæœ¬
â”œâ”€ renderer/        # æ¸²æŸ“è¿›ç¨‹é¡µé¢èµ„æº
â”‚  â”œâ”€ index.html
â”‚  â”œâ”€ renderer.js
â”œâ”€ package.json
â”œâ”€ .vscode/         # è°ƒè¯•é…ç½®
â””â”€ node_modules/
```

âœ… åˆ›å»ºå¥½ç©ºçš„ `main.js`ã€`preload.js`ã€`renderer/index.html`ã€`renderer/renderer.js` æ–‡ä»¶ã€‚

**ç¬¬4æ­¥ï¼šç¼–å†™åŸºç¡€ä»£ç **

ğŸ”¹ main.js

```js
const { app, BrowserWindow } = require('electron');
const path = require('path');

function createWindow() {
  const win = new BrowserWindow({
    width: 800,
    height: 600,
    webPreferences: {
      preload: path.join(__dirname, 'preload.js'),
      nodeIntegration: true,   // æ³¨æ„ï¼šå¼€å‘é˜¶æ®µå…ˆå¼€ç€ï¼Œåé¢å­¦åˆ°å®‰å…¨æ€§å†å¤„ç†
      contextIsolation: false,
      devTools: true
    }
  });

  win.loadFile('renderer/index.html');
  win.webContents.openDevTools();
}

app.whenReady().then(createWindow);

app.on('window-all-closed', () => {
  if (process.platform !== 'darwin') {
    app.quit();
  }
});
```

ğŸ”¹ preload.js

```js
// è¿™é‡Œæš‚æ—¶å…ˆç•™ç©ºï¼Œåé¢é€šä¿¡éƒ¨åˆ†ä¼šåŠ ä¸Š
```

ğŸ”¹ renderer/index.html

```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>My Electron App</title>
</head>
<body>
  <h1>Hello Electron!</h1>
  <script src="renderer.js"></script>
</body>
</html>
```

ğŸ”¹ renderer/renderer.js

```js
console.log("Renderer process started!");
```

**ç¬¬5æ­¥ï¼šé…ç½® npm scripts**

æ‰“å¼€ `package.json`ï¼Œæ·»åŠ ä¸€æ®µï¼š

```js
"scripts": {
  "dev": "electron ."
}
```

âœ… è¿™æ ·ä»¥åå°±å¯ä»¥ç›´æ¥ `npm run dev` å¯åŠ¨ Electronï¼Œè€Œä¸ç”¨è‡ªå·±æ•² `npx electron .`

**ç¬¬6æ­¥ï¼šé…ç½® VSCode æ–­ç‚¹è°ƒè¯•**

ç°åœ¨æˆ‘ä»¬æ¥é…ç½® `.vscode/launch.json` æ–‡ä»¶ï¼š

1. åœ¨ VSCode é‡Œï¼Œç‚¹å·¦è¾¹çš„â€œè¿è¡Œå’Œè°ƒè¯•â€é¢æ¿ã€‚
2. é€‰æ‹© â€œåˆ›å»º launch.jsonâ€ -> é€‰ Node.js ç±»å‹ã€‚
3. å¡«å†™ä¸ºï¼š

```json
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Debug Electron Main Process",
      "type": "node",
      "request": "launch",
      "program": "${workspaceFolder}/main.js",
      "runtimeExecutable": "${workspaceFolder}/node_modules/.bin/electron",
      "windows": {
        "runtimeExecutable": "${workspaceFolder}/node_modules/.bin/electron.cmd"
      },
      "cwd": "${workspaceFolder}",
      "outFiles": [
        "${workspaceFolder}/**/*.js"
      ],
      "console": "integratedTerminal",
      "internalConsoleOptions": "neverOpen"
    }
  ]
}
```

âœ… é…ç½®å¥½ä»¥åï¼Œ**ä½ å¯ä»¥åœ¨ `main.js` é‡Œæ‰“æ–­ç‚¹ï¼Œç›´æ¥ F5 è°ƒè¯•è¿è¡Œï¼**

**ç¬¬7æ­¥ï¼šå¯åŠ¨æµ‹è¯•**

ç°åœ¨å¯ä»¥è¯•è¯•ï¼š

- **åœ¨ `main.js` é‡Œä»»æ„åœ°æ–¹æ‰“ä¸ªæ–­ç‚¹**ï¼ˆæ¯”å¦‚ `createWindow()` é‡Œï¼‰
- æŒ‰ F5 æˆ–ç‚¹å‡» "å¯åŠ¨è°ƒè¯•"
- åº”è¯¥ Electron çª—å£èƒ½æ­£å¸¸å¯åŠ¨
- åº”è¯¥åˆ°æ–­ç‚¹æ—¶èƒ½åœä¸‹æ¥ï¼

å¦å¤–ï¼Œåœ¨ Electron çª—å£æ‰“å¼€åï¼š

- æŒ‰ `Ctrl+Shift+I`
- æ‰“å¼€ DevTools
- åœ¨ Sources é¢æ¿çœ‹åˆ° `renderer.js`
- å¯ä»¥æ‰“æ–­ç‚¹è°ƒè¯•å‰ç«¯é¡µé¢é€»è¾‘

âœ… å®Œæˆï¼

# 3. Electron é¡¹ç›®çš„åŸºæœ¬æ¶æ„

## 3.1 ä¸»è¿›ç¨‹ä¸æ¸²æŸ“è¿›ç¨‹

### ä¸»è¿›ç¨‹
å°±æ˜¯ Electron ç¨‹åºçš„ **å¤§è„‘**ï¼Œå®ƒè´Ÿè´£ï¼š

- åˆ›å»ºçª—å£
- ç›‘å¬ç¨‹åºç”Ÿå‘½å‘¨æœŸï¼ˆæ¯”å¦‚ç¨‹åºå¯åŠ¨ã€é€€å‡ºï¼‰
- è°ƒç”¨ Node.js çš„èƒ½åŠ›ï¼ˆæ¯”å¦‚è®¿é—®æ–‡ä»¶ç³»ç»Ÿï¼‰
- ç®¡ç†å¤šä¸ªçª—å£ä¹‹é—´çš„é€šè®¯
- æ§åˆ¶æ•´ä¸ªåº”ç”¨çš„è¡Œä¸º

ğŸ§  **ä½ å¯ä»¥ç†è§£æˆ â€œåç«¯/æ“ä½œç³»ç»Ÿç®¡ç†è€…â€ã€‚**

ä¸»è¿›ç¨‹å¯¹åº”çš„é€šå¸¸æ˜¯ä½ çš„ `main.js` æ–‡ä»¶ã€‚

### æ¸²æŸ“è¿›ç¨‹
å°±æ˜¯ **æ¯ä¸€ä¸ª Electron çª—å£é‡Œè·‘çš„å‰ç«¯é¡µé¢**ã€‚

æ¯”å¦‚ï¼š

- ä¸€ä¸ª `BrowserWindow` å°±æ˜¯ä¸€ä¸ªæ¸²æŸ“è¿›ç¨‹
- æ¸²æŸ“è¿›ç¨‹é‡Œå°±åƒæµè§ˆå™¨é¡µé¢ï¼Œè·‘çš„æ˜¯ HTML + CSS + JS

ğŸ–¥ï¸ **ä½ å¯ä»¥ç†è§£æˆ â€œå‰ç«¯ç•Œé¢â€**ã€‚

**æ¯ä¸ªçª—å£**éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ¸²æŸ“è¿›ç¨‹ï¼ˆäº’ä¸å¹²æ‰°ï¼‰ã€‚

| é¡¹ç›®     | ä¸»è¿›ç¨‹                       | æ¸²æŸ“è¿›ç¨‹                       |
| -------- | ---------------------------- | ------------------------------ |
| è§’è‰²     | ç®¡ç†å‘˜                       | é¡µé¢                           |
| è¿è¡Œå†…å®¹ | Node.js è„šæœ¬                 | ç½‘é¡µ (HTML/CSS/JS)             |
| æ§åˆ¶å¯¹è±¡ | æ•´ä¸ªåº”ç”¨                     | å•ä¸ªçª—å£çš„ç•Œé¢                 |
| èƒ½åŠ›     | Node.js èƒ½åŠ›ã€ç³»ç»Ÿ API       | å‰ç«¯æ“ä½œï¼ˆéƒ¨åˆ†å¯ä»¥ç”¨ Node.jsï¼‰ |
| ä¾‹å­     | åˆ›å»º BrowserWindowï¼Œç›‘å¬é€€å‡º | æ˜¾ç¤ºæŒ‰é’®ã€å¤„ç†ç”¨æˆ·è¾“å…¥         |

### ä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡

åœ¨ Electron é‡Œï¼Œ**ä¸»è¿›ç¨‹**ï¼ˆMainï¼‰å’Œ**æ¸²æŸ“è¿›ç¨‹**ï¼ˆRendererï¼‰
 æœ¬è´¨ä¸Šæ˜¯**ä¸¤ä¸ªç‹¬ç«‹çš„è¿›ç¨‹**ï¼Œæ‰€ä»¥å®ƒä»¬ä¹‹é—´ä¸èƒ½ç›´æ¥äº’ç›¸è°ƒç”¨ä»£ç ã€‚

ä¸ºäº†é€šä¿¡ï¼ŒElectron æä¾›äº†**ä¸“é—¨çš„æœºåˆ¶**ï¼š
 **IPCï¼ˆInter-Process Communicationï¼Œè¿›ç¨‹é—´é€šä¿¡ï¼‰**

Electronçš„å®˜æ–¹æ¨¡å—æ˜¯ï¼š

| æ¨¡å—          | ç”¨é€”             |
| ------------- | ---------------- |
| `ipcMain`     | ä¸»è¿›ç¨‹ç›‘å¬æ¶ˆæ¯   |
| `ipcRenderer` | æ¸²æŸ“è¿›ç¨‹å‘é€æ¶ˆæ¯ |

**ä¹Ÿå°±æ˜¯è¯´ï¼š**

- æ¸²æŸ“è¿›ç¨‹ç”¨ `ipcRenderer.invoke()` å‘ä¸»è¿›ç¨‹å‘æ¶ˆæ¯
- ä¸»è¿›ç¨‹ç”¨ `ipcMain.on()` æ”¶åˆ°æ¶ˆæ¯
- åè¿‡æ¥ï¼Œä¸»è¿›ç¨‹å¯ä»¥ç”¨ `event.reply()` å›å¤æ¸²æŸ“è¿›ç¨‹

#### preload.js

**preload.js æ˜¯èµ·â€œä¸­é—´äººâ€çš„ä½œç”¨**ï¼

- ä½ å¯ä»¥åœ¨ preload.js é‡Œä½¿ç”¨ **Node.js API + ipcRenderer**
- ç„¶åæŠŠéœ€è¦çš„èƒ½åŠ›ï¼Œ**é€šè¿‡å®‰å…¨çš„ API**æŒ‚åˆ°æ¸²æŸ“è¿›ç¨‹çš„ `window` ä¸Š
- è¿™æ ·**æ¸²æŸ“è¿›ç¨‹å°±ä¸ç”¨ç›´æ¥æ¥è§¦ ipcRenderer å’Œ Node.js äº†**ï¼Œæ›´å®‰å…¨ï¼

æ‰€ä»¥ï¼Œpreload.js æ˜¯ï¼š

- è¿æ¥ æ¸²æŸ“è¿›ç¨‹ å’Œ ä¸»è¿›ç¨‹ çš„æ¡¥æ¢
- æŠŠ ipcRenderer åŒ…èµ·æ¥ï¼Œé˜²æ­¢æ¸²æŸ“è¿›ç¨‹æ»¥ç”¨

**ç¤ºä¾‹ï¼š**

1. **æ¸²æŸ“è¿›ç¨‹ --> preload.js --> ä¸»è¿›ç¨‹**

åœ¨ `preload.js` é‡Œæš´éœ²å®‰å…¨æ–¹æ³•ï¼š

```js
const { contextBridge, ipcRenderer } = require('electron');

contextBridge.exposeInMainWorld('myAPI', {
  readFile: (path) => ipcRenderer.invoke('read-file', path),
});
```

2. **ä¸»è¿›ç¨‹ main.js é‡Œç›‘å¬**

```js
const { ipcMain } = require('electron');
const fs = require('fs');

ipcMain.handle('read-file', async (event, path) => {
  const content = fs.readFileSync(path, 'utf-8');
  return content;
});
```

3. **æ¸²æŸ“è¿›ç¨‹ä½¿ç”¨**

åœ¨ `renderer.js` é‡Œè°ƒç”¨ï¼š

```js
async function readFileContent() {
  const content = await window.myAPI.readFile('somefile.txt');
  console.log(content);
}
```

**ä¸ºä»€ä¹ˆè¦ preload?**

- **ä¸å»ºè®®ç›´æ¥åœ¨æ¸²æŸ“è¿›ç¨‹ç”¨ ipcRenderer.send**ï¼Œå› ä¸ºæ¸²æŸ“è¿›ç¨‹æ˜¯å¯ä»¥è¢«ç½‘é¡µæ”»å‡»çš„ï¼ˆè·¨ç«™è„šæœ¬æ”»å‡»ï¼‰ã€‚
- æ­£ç¡®åšæ³•æ˜¯ç”¨ preload.js æš´éœ²æœ‰é™çš„ã€å®‰å…¨çš„APIï¼Œé˜²æ­¢æ¸²æŸ“è¿›ç¨‹èƒ½ä¹±è°ƒç”¨ç³»ç»ŸAPIã€‚

âœ…preload.js æ˜¯ **ä¸»è¿›ç¨‹è¿è¡Œçš„è„šæœ¬**ï¼Œä½†**åœ¨æ¸²æŸ“è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­æå‰æ³¨å…¥å˜é‡**ã€‚
 è¿™æ ·èƒ½è®©æ¸²æŸ“é¡µé¢åªæ‹¿åˆ°â€œè¿‡æ»¤åçš„å®‰å…¨åŠŸèƒ½â€ã€‚

## 3.2 é¡¹ç›®ç»“æ„

æ ‡å‡†ä¸€ä¸ªç®€å•çš„ Electron é¡¹ç›®ï¼Œé€šå¸¸é•¿è¿™æ ·ï¼š

```bash
project-folder/
â”œâ”€ main.js          # ä¸»è¿›ç¨‹å…¥å£
â”œâ”€ preload.js       # (å¯é€‰)é¢„åŠ è½½è„šæœ¬ï¼Œæ³¨å…¥ç»™æ¸²æŸ“è¿›ç¨‹ç”¨
â”œâ”€ renderer/        # æ¸²æŸ“è¿›ç¨‹é¡µé¢èµ„æº
â”‚  â”œâ”€ index.html    # ç•Œé¢ HTML
â”‚  â”œâ”€ renderer.js   # ç•Œé¢é€»è¾‘
â”œâ”€ modules/         # ä½ çš„ä¸šåŠ¡é€»è¾‘æ¨¡å—
â”œâ”€ package.json     # npmåŒ…ç®¡ç†ï¼Œå®šä¹‰ Electron ç‰ˆæœ¬å’Œå¯åŠ¨è„šæœ¬
â”œâ”€ .vscode/         # è°ƒè¯•é…ç½®
â”œâ”€ node_modules/    # ä¾èµ–åº“
```

å„éƒ¨åˆ†çš„ä½œç”¨ï¼š

| ç›®å½•/æ–‡ä»¶      | ä½œç”¨                                           |
| -------------- | ---------------------------------------------- |
| `main.js`      | è´Ÿè´£å¯åŠ¨ Electron åº”ç”¨ï¼Œç®¡ç†çª—å£ã€ç›‘å¬äº‹ä»¶     |
| `preload.js`   | ï¼ˆå¯é€‰ï¼‰åœ¨æ¸²æŸ“è¿›ç¨‹åŠ è½½å‰ï¼Œæå‰æ³¨å…¥å®‰å…¨æ¥å£     |
| `renderer/`    | ç•Œé¢æ˜¾ç¤ºå’Œç•Œé¢é€»è¾‘ï¼ˆæ¸²æŸ“è¿›ç¨‹ä»£ç ï¼‰             |
| `modules/`     | å­˜æ”¾å°è£…çš„å·¥å…·æ¨¡å—ï¼Œæ¯”å¦‚å¤„ç†å›¾ç‰‡ã€å¤„ç† YAML ç­‰ |
| `package.json` | å®šä¹‰åº”ç”¨ä¿¡æ¯ã€ä¾èµ–ã€Electronç‰ˆæœ¬ã€å¯åŠ¨å‘½ä»¤ç­‰   |

å¯åŠ¨ Electron åº”ç”¨åï¼Œå®ƒçš„æµç¨‹å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š

1. è¿è¡Œ `main.js` ï¼ˆä¸»è¿›ç¨‹å¯åŠ¨ï¼‰
2. `main.js` åˆ›å»ºä¸€ä¸ªæ–°çš„ `BrowserWindow`
3. `BrowserWindow` åŠ è½½ä½ çš„ `index.html`
4. `index.html` é‡Œè¿è¡Œ `renderer.js` ï¼ˆæ¸²æŸ“è¿›ç¨‹é€»è¾‘ï¼‰
5. å¦‚æœæœ‰ `preload.js`ï¼Œåœ¨æ¸²æŸ“è¿›ç¨‹å¼€å§‹ä¹‹å‰æ³¨å…¥ç‰¹å®šçš„ Node.js èƒ½åŠ›ï¼ˆé˜²æ­¢ç›´æ¥æš´éœ² Nodeï¼‰
6. ä¸»è¿›ç¨‹ç›‘å¬çª—å£å…³é—­ã€åº”ç”¨é€€å‡ºç­‰ç­‰äº‹ä»¶
7. æ¸²æŸ“è¿›ç¨‹å“åº”ç”¨æˆ·æ“ä½œï¼Œæ¯”å¦‚æŒ‰é’®ã€è¾“å…¥æ¡†

### Electronæ¶æ„ä¸MVC

| å±‚                           | ä½œç”¨               | ç±»ä¼¼ä¼ ç»ŸMVCé‡Œå“ªä¸ªè§’è‰² |
| ---------------------------- | ------------------ | --------------------- |
| ä¸»è¿›ç¨‹ï¼ˆMain Processï¼‰       | åº”ç”¨ç®¡ç†ï¼Œåƒâ€œåç«¯â€ | Model / Controller    |
| æ¸²æŸ“è¿›ç¨‹ï¼ˆRenderer Processï¼‰ | é¡µé¢å±•ç¤ºã€äº¤äº’     | View / Controller     |

å¯ä»¥è¿™ä¹ˆåˆ†ï¼š

- **Model**ï¼šæ”¾åœ¨ä¸»è¿›ç¨‹ / modules é‡Œï¼Œæ¯”å¦‚ï¼š
  - æ–‡ä»¶ç®¡ç†ï¼ˆfileServiceï¼‰
  - é…ç½®ç®¡ç†ï¼ˆconfigServiceï¼‰
  - ç½‘ç»œé€šä¿¡ï¼ˆnetworkServiceï¼‰
- **View**ï¼šæ”¾åœ¨æ¸²æŸ“è¿›ç¨‹çš„ HTML + CSS + JS é¡µé¢ï¼Œæ¯”å¦‚ï¼š
  - æŒ‰é’®ã€åˆ—è¡¨ã€å¼¹çª—ã€ç•Œé¢å¸ƒå±€
- **Controller**ï¼š
  - ä¸»è¿›ç¨‹ç®¡ç†åº”ç”¨è¡Œä¸ºï¼ˆæ‰“å¼€çª—å£ã€å…³é—­çª—å£ï¼‰
  - æ¸²æŸ“è¿›ç¨‹ç®¡ç†ç”¨æˆ·æ“ä½œï¼ˆç‚¹å‡»æŒ‰é’® -> è°ƒç”¨ preload æš´éœ²çš„ APIï¼‰

### ä»£ç åˆ†ç±»

| ä»£ç ç±»å‹          | å±äºä»€ä¹ˆè¿›ç¨‹ï¼Ÿ   | å…¸å‹æ–‡ä»¶                          |
| ----------------- | ---------------- | --------------------------------- |
| ä¸»è¿›ç¨‹ä»£ç         | Main Process     | main.js                           |
| é¢„åŠ è½½è„šæœ¬        | Preload Script   | preload.js                        |
| æ¸²æŸ“è¿›ç¨‹é¡µé¢ä»£ç   | Renderer Process | renderer/index.html + renderer.js |
| åŠ¨æ€requireçš„æ¨¡å— | ç”±è°ƒç”¨ä½ç½®å†³å®š   | modules/*.js                      |

# 4.è°ƒè¯•æ–¹æ³•

## 4.1 ä¸»è¿›ç¨‹ä»£ç ï¼ˆmain.jsï¼‰

**ç‰¹ç‚¹ï¼š**

- ä¸»è¿›ç¨‹å°±æ˜¯ Node.js è¿è¡Œçš„è¿›ç¨‹
- å®Œå…¨å¯ä»¥ç›´æ¥ç”¨ **VSCodeå†…ç½®è°ƒè¯•å™¨**æ–­ç‚¹è°ƒè¯•

**æ‰“æ–­ç‚¹æ–¹æ³•ï¼š**

- é…ç½® `.vscode/launch.json`
- `type: node`
- `program: main.js`
- æŒ‰ `F5` å¯åŠ¨ï¼Œç›´æ¥åœ¨ VSCode æ‰“æ–­ç‚¹ï¼Œ100%ç”Ÿæ•ˆã€‚

âœ… ä¸»è¿›ç¨‹è°ƒè¯• = **å’Œæ™®é€š Node.js é¡¹ç›®ä¸€æ¨¡ä¸€æ ·**

## 4.2 é¢„åŠ è½½è„šæœ¬ï¼ˆpreload.jsï¼‰

**ç‰¹ç‚¹ï¼š**

- preload.js æ˜¯åœ¨**ä¸»è¿›ç¨‹åˆ›å»º BrowserWindow æ—¶è¿è¡Œ**çš„
- ä½†æ˜¯æ‰§è¡Œç¯å¢ƒæ˜¯**æ¸²æŸ“è¿›ç¨‹çš„ä¸Šä¸‹æ–‡**

**æ‰“æ–­ç‚¹æ–¹æ³•ï¼š**

- **å¦‚æœ preload.js æ˜¯ç”¨ `require` åŠ è½½çš„**ï¼Œå¯ä»¥åœ¨ VSCodeç›´æ¥æ–­ç‚¹ï¼
- preload é‡Œè·‘çš„é€»è¾‘ï¼Œæœ€å¥½é…åˆ DevTools ä¹Ÿèƒ½çœ‹ï¼ˆå› ä¸ºæ˜¯æ³¨å…¥åˆ°é¡µé¢é‡Œçš„ï¼‰

**å°ç»†èŠ‚è¡¥å……ï¼š**

- preload æœ¬è´¨ä¸Šæ˜¯ **ä¸»è¿›ç¨‹æ‰“åŒ…æ¸²æŸ“å‰**æå‰æ‰§è¡Œçš„å°è„šæœ¬
- å®ƒå’Œä¸»è¿›ç¨‹æœ¬èº«å…³ç³»å¯†åˆ‡ï¼Œæ‰€ä»¥è°ƒè¯•æ–¹å¼å’Œ main.js ç±»ä¼¼

âœ… preload è°ƒè¯• = **VSCodeå¯ä»¥æ‰“æ–­ç‚¹ï¼Œä½†æ›´å‡†ç¡®çš„æ˜¯ç»“åˆ DevToolsæŸ¥çœ‹ windowæ³¨å…¥å†…å®¹ã€‚**

## 4.3 æ¸²æŸ“è¿›ç¨‹é¡µé¢ä»£ç ï¼ˆrenderer/*.jsï¼‰

**ç‰¹ç‚¹ï¼š**

- æ˜¯ Chromium æµè§ˆå™¨åŠ è½½çš„ HTML/JS é¡µé¢
- å’Œå‰ç«¯ç½‘é¡µä¸€æ ·ï¼Œåªèƒ½åœ¨æµè§ˆå™¨ç¯å¢ƒè°ƒè¯•

**æ‰“æ–­ç‚¹æ–¹æ³•ï¼š**

- **æ‰“å¼€Electronçª—å£åï¼ŒæŒ‰ `Ctrl+Shift+I` æ‰“å¼€ DevTools**
- åœ¨ DevTools çš„ Sources é¢æ¿é‡Œæ‰¾åˆ°ä½ çš„ `renderer.js`
- åœ¨é‡Œé¢æ‰“æ–­ç‚¹
- é¡µé¢æ‰§è¡Œåˆ°ç›¸åº”é€»è¾‘æ—¶ï¼Œæ–­ç‚¹ä¼šå‘½ä¸­

âœ… æ¸²æŸ“è¿›ç¨‹è°ƒè¯• = **ç”¨ Electronçª—å£é‡Œçš„ DevToolsæ‰“æ–­ç‚¹ï¼ˆå°±åƒè°ƒç½‘é¡µä¸€æ ·ï¼‰**

## 4.4 åŠ¨æ€requireçš„æ¨¡å—ï¼ˆmodules/*.jsï¼‰

**ç‰¹ç‚¹ï¼š**

- modules å¯èƒ½è¢«ä¸»è¿›ç¨‹ã€é¢„åŠ è½½è„šæœ¬ã€æ¸²æŸ“è¿›ç¨‹require
- **å®ƒå±äºå“ªä¸ªè¿›ç¨‹ï¼Œå–å†³äºè°requireå®ƒ**

## 4.5 æ€»ç»“

**æ‰“æ–­ç‚¹æ–¹æ³•ï¼š**

| è° require modules/*.jsï¼Ÿ                      | æ‰“æ–­ç‚¹æ–¹å¼                       |
| ---------------------------------------------- | -------------------------------- |
| main.js require                                | VSCodeæ–­ç‚¹è°ƒè¯•                   |
| preload.js require                             | VSCodeæ–­ç‚¹è°ƒè¯•ï¼ˆä½†æ³¨æ„æ‰§è¡Œæ—¶æœºï¼‰ |
| renderer.js requireï¼ˆå¦‚æœnodeIntegrationå¼€ç€ï¼‰ | Electron DevToolsæ‰“æ–­ç‚¹          |

âœ… modulesè°ƒè¯• = **çœ‹è°ƒç”¨è€…æ˜¯è°ï¼Œè·Ÿç€é‚£ä¸ªè¿›ç¨‹çš„è°ƒè¯•æ–¹å¼èµ°ï¼**

**ä¸ºä»€ä¹ˆæœ‰æ—¶å€™æ‰“ä¸ä¸Šæ–­ç‚¹ï¼Ÿ**

å‡ ä¸ªå¸¸è§åŸå› æ€»ç»“ï¼š

| é—®é¢˜                                                 | è§£é‡Š                                              |
| ---------------------------------------------------- | ------------------------------------------------- |
| æ‰“åœ¨ä¸»è¿›ç¨‹æ–‡ä»¶ä¸Šï¼Œä½† Electron æ˜¯æ™®é€šè¿è¡Œï¼ˆæ²¡è°ƒè¯•å™¨ï¼‰ | å¿…é¡»ç”¨ VSCode launch.jsonå¯åŠ¨è°ƒè¯•æ¨¡å¼ï¼Œå¦åˆ™æ‰“ä¸ä¸Š |
| æ‰“åœ¨æ¸²æŸ“è¿›ç¨‹æ–‡ä»¶ä¸Šï¼Œä½†æ²¡æ‰“å¼€ DevTools                | æ¸²æŸ“è¿›ç¨‹å¿…é¡»ç”¨ DevToolsæ–­ç‚¹                       |
| modulesæ–‡ä»¶æ‰“æ–­ç‚¹ï¼Œä½†è°ƒç”¨è€…æ˜¯æ¸²æŸ“è¿›ç¨‹                | åº”è¯¥å» DevToolsé‡Œæ‰“ï¼Œè€Œä¸æ˜¯VSCodeé‡Œæ‰“             |
| æ–‡ä»¶æ˜ å°„é”™è¯¯ï¼ˆæ¯”å¦‚ç”¨webpackæ‰“åŒ…äº†ï¼‰                  | éœ€è¦æ­£ç¡®çš„ source-map å’Œ outFiles é…ç½®            |

# Electronç¨‹åºæ‰“åŒ…ï¼ˆç”¨ electron-builderï¼‰

**æœ€ç»ˆç›®æ ‡ï¼š**

- æŠŠå¼€å‘å®Œæˆçš„ Electron é¡¹ç›®
- æ‰“æˆ `.exe` å®‰è£…ç¨‹åºï¼ˆWindowsï¼‰
- æˆ– `.dmg` å®‰è£…åŒ…ï¼ˆMacï¼‰
- ä¸ç”¨ Nodeã€ä¸ç”¨ VSCodeï¼Œæ™®é€šç”µè„‘ç›´æ¥å®‰è£…ã€è¿è¡Œï¼

**ç¬¬1æ­¥ï¼šå®‰è£… electron-builder**

åœ¨ä½ çš„é¡¹ç›®ç›®å½•ä¸‹ï¼Œæ‰§è¡Œï¼š

```bash
npm install electron-builder --save-dev
```

âœ… è¿™æ ·å°±æŠŠ `electron-builder` è£…åˆ°å¼€å‘ä¾èµ–é‡Œäº†ã€‚

**ç¬¬2æ­¥ï¼šä¿®æ”¹ package.json**

æ‰“å¼€ä½ çš„ `package.json`ï¼Œåšä¸¤ä»¶äº‹ï¼š

1. **åŠ ä¸Šæ‰“åŒ…é…ç½®ï¼ˆ`build` å­—æ®µï¼‰**

åœ¨ `package.json` é‡Œï¼Œæ·»åŠ ä¸€æ®µæ–°çš„å­—æ®µ `build`ï¼š

```json
"build": {
  "appId": "com.yourcompany.yourapp",
  "productName": "SmartMDImporter", 
  "directories": {
    "output": "dist"
  },
  "files": [
    "**/*"
  ],
  "win": {
    "target": "nsis"
  },
  "mac": {
    "target": "dmg"
  }
}
```

ğŸ”¹ å‚æ•°è§£é‡Šï¼š

| å‚æ•°                 | æ„ä¹‰                                     |
| -------------------- | ---------------------------------------- |
| `appId`              | åº”ç”¨å”¯ä¸€IDï¼Œè§„èŒƒå†™æ³•æ˜¯ com.å…¬å¸å.åº”ç”¨å |
| `productName`        | åº”ç”¨æ˜¾ç¤ºåç§°ï¼ˆå®‰è£…åŒ…ã€çª—å£æ ‡é¢˜ä¼šç”¨ï¼‰     |
| `directories.output` | æ‰“åŒ…åè¾“å‡ºçš„ç›®å½•                         |
| `files`              | æŒ‡å®šè¦æ‰“åŒ…è¿›å»çš„æ–‡ä»¶                     |
| `win.target`         | Windows å¹³å°æ‰“æˆ NSISå®‰è£…ç¨‹åº            |
| `mac.target`         | Mac å¹³å°æ‰“æˆ dmgé•œåƒ                     |

âœ… è¿™æ · Electron-Builder çŸ¥é“è¦æ€ä¹ˆæ‰“åŒ…ä½ çš„åº”ç”¨äº†ï¼

2. **åŠ ä¸Šæ‰“åŒ…è„šæœ¬**

åœ¨ `scripts` éƒ¨åˆ†åŠ ä¸¤ä¸ªæŒ‡ä»¤ï¼š

```json
"scripts": {
  "dev": "electron .",
  "build": "electron-builder",
  "build:win": "electron-builder --win",
  "build:mac": "electron-builder --mac"
}
```

è¿™æ ·ä½ å¯ä»¥ç›´æ¥ç”¨ï¼š

- `npm run build`ï¼šæ‰“åŒ…å½“å‰å¹³å°ï¼ˆæ¯”å¦‚ Windowsï¼‰
- `npm run build:win`ï¼šåªæ‰“åŒ… Windows å®‰è£…ç¨‹åº
- `npm run build:mac`ï¼šåªæ‰“åŒ… Mac å®‰è£…åŒ…

å¦‚æœä½ æƒ³æ¢åº”ç”¨å›¾æ ‡ï¼ˆé»˜è®¤æ˜¯ Electronå›¾æ ‡ğŸªï¼‰ï¼Œå¯ä»¥åœ¨ build å­—æ®µåŠ ä¸Šï¼š

```json
"win": {
  "icon": "build/icon.ico",
  "target": "nsis"
}
```

ç„¶åæ”¾ä¸€å¼  `.ico` æ ¼å¼çš„å›¾æ ‡æ–‡ä»¶åˆ° `build/` æ–‡ä»¶å¤¹é‡Œã€‚

**ç¬¬3æ­¥ï¼šæ‰§è¡Œæ‰“åŒ…**

ç°åœ¨ä½ å¯ä»¥ç›´æ¥æ‰§è¡Œæ‰“åŒ…å‘½ä»¤äº†ï¼

```bash
npm run build
```

Electron-Builderä¼šè‡ªåŠ¨ï¼š

- æ£€æŸ¥ä½ çš„ `main.js`ã€`renderer/` è¿™äº›æ–‡ä»¶
- æ‰“æˆä¸€ä¸ªå®‰è£…ç¨‹åºï¼Œæ¯”å¦‚ `dist/SmartMDImporter Setup 1.0.0.exe`

âœ… å®Œæˆï¼

æ‰“åŒ…å®Œä»¥åï¼Œ`dist/` ç›®å½•å¤§æ¦‚æ˜¯è¿™æ ·ï¼š

```
bashå¤åˆ¶ç¼–è¾‘dist/
â”œâ”€ SmartMDImporter Setup 1.0.0.exe   # å®‰è£…ç¨‹åº
â”œâ”€ SmartMDImporter-1.0.0.exe         # ç»¿è‰²ç‰ˆå¯æ‰§è¡Œæ–‡ä»¶
â”œâ”€ SmartMDImporter-1.0.0/            # è§£å‹åçš„æ–‡ä»¶å¤¹
```

ä½ å¯ä»¥ç›´æ¥æ‹¿ `.exe` å‘ç»™åˆ«äººï¼æˆ–è€…è‡ªå·±åŒå‡» `.exe` å®‰è£…ä½“éªŒï¼

**æ‰“åŒ…å¸¸è§é—®é¢˜**

| é—®é¢˜                   | è§£å†³åŠæ³•                                                     |
| ---------------------- | ------------------------------------------------------------ |
| æ‰“åŒ…æ—¶å‡ºé”™æ‰¾ä¸åˆ°ä¾èµ–   | ç¡®è®¤ `node_modules` é‡Œçš„æ¨¡å—å­˜åœ¨                             |
| æ‰“åŒ…åè¿è¡Œæ—¶æŠ¥è·¯å¾„é”™è¯¯ | ç¡®è®¤ç”¨äº† `path.join(__dirname, xxx)`ï¼Œä¸è¦ç”¨ç›¸å¯¹è·¯å¾„         |
| çª—å£æ‰“ä¸å¼€             | æ£€æŸ¥ `main.js` æœ‰æ²¡æœ‰æ­£ç¡® `loadFile()` æŒ‡å‘ renderer/index.html |
| æƒ³è®©æ‰“åŒ…å‡ºçš„çª—å£æ— èœå• | `win.setMenu(null);` åŠ åœ¨ `BrowserWindow` é‡Œ                 |

